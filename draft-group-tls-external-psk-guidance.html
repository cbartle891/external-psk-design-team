<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Guidance for External PSK Usage in TLS</title>
<meta content="Foo Bar" name="author">
<meta content="
       This document provides usage guidance for external Pre-Shared Keys (PSKs) in TLS.
It lists TLS security properties provided by PSKs under certain assumptions and
demonstrates how violations of these assumptions lead to attacks. This document
also discusses PSK use cases, provisioning processes, and TLS stack implementation
support in the context of these assumptions. It provides advice for applications
in various use cases to help meet these assumptions. 
    " name="description">
<meta content="xml2rfc 2.39.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-group-tls-external-psk-guidance-latest" name="ietf.draft">
<link href="draft-group-tls-external-psk-guidance.xml" type="application/rfc+xml" rel="alternate">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --small-font-size: 14.5px;
}
body {
  max-width: 624px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  padding: 1em 0 0.2em;
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1, h2, h3 {
  font-size: 22px;
  line-height: 26px;
}
h4, h5, h6 {
  font-size: 18px;
  line-height: 22px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  line-height: 17px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
  table {
    display: inline-block;
    overflow-x: auto;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #eee;
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  font-style: italic;
  margin: 0.3em 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  visibility: hidden;
  user-select: none;
}
a.pilcrow[href] { color: #ddd; }
a.pilcrow[href]:hover { text-decoration: none; }
@media screen {
  :hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 600px) {
  #authors-addresses {
    display: relative;
    padding: 32px 0 0;
    column-count: 2;
    column-gap: 20px;
  }
  #name-authors-addresses {
    position: absolute;
    top: 0px;
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
  }
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #b76427;
  background-color: rgba(249, 232, 105, 0.3);
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: rgba(249, 232, 105, 0.3);
  border-radius: 3px;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 953px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.9; /* TODO fix when Henrik takes the patch. */
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 954px) {
  body {
    padding-right: 380px;
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>
<link href="rfc-local.css" type="text/css" rel="stylesheet">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Guidance for External PSK Usage in TLS</td>
<td class="right">March 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Bar</td>
<td class="center">Expires 2 September 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">tls</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-group-tls-external-psk-guidance-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-03-01" class="published">1 March 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-09-02">2 September 2020</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Bar</div>
<div class="org">Baz, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Guidance for External PSK Usage in TLS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document provides usage guidance for external Pre-Shared Keys (PSKs) in TLS.
It lists TLS security properties provided by PSKs under certain assumptions and
demonstrates how violations of these assumptions lead to attacks. This document
also discusses PSK use cases, provisioning processes, and TLS stack implementation
support in the context of these assumptions. It provides advice for applications
in various use cases to help meet these assumptions.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-note-to-readers">
<a href="#name-note-to-readers" class="section-name selfRef">Note to Readers</a>
      </h2>
<p id="section-note.1-1">Source for this draft and an issue tracker can be found at
  <a href="https://github.com/tlswg/external-psk-design-team">https://github.com/tlswg/external-psk-design-team</a>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 2 September 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions-and-definitions" class="xref">Conventions and Definitions</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-psk-security-properties" class="xref">PSK Security Properties</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-security-assumption-violati" class="xref">Security Assumption Violations</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-redirection-selfie-style" class="xref">Redirection (Selfie-style)</a><a href="#section-toc.1-1.3.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-lack-of-dhe" class="xref">Lack of DHE</a><a href="#section-toc.1-1.3.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="xref">3.1.3</a>.  <a href="#name-compromise-of-an-uninvolved" class="xref">Compromise of an uninvolved node</a><a href="#section-toc.1-1.3.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-recommendations-for-externa" class="xref">Recommendations for External PSK Usage</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-privacy-properties" class="xref">Privacy Properties</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-external-psk-use-cases-and-" class="xref">External PSK Use Cases and Provisioning Processes</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-provisioning-examples" class="xref">Provisioning Examples</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-provisioning-constraints" class="xref">Provisioning Constraints</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-stack-interfaces" class="xref">Stack Interfaces</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="xref">6.3.1</a>.  <a href="#name-psk-identity-encoding-and-c" class="xref">PSK Identity encoding and comparison</a><a href="#section-toc.1-1.6.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">TODO<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-properties">
<section id="section-3">
      <h2 id="name-psk-security-properties">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-psk-security-properties" class="section-name selfRef">PSK Security Properties</a>
      </h2>
<p id="section-3-1">TLS 1.3 tries to maintain the following seven security properties:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal" id="section-3-2">
        <li id="section-3-2.1">Matching the same session keys;<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
<li id="section-3-2.2">Session key secrecy;<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
<li id="section-3-2.3">Peer authentication;<a href="#section-3-2.3" class="pilcrow">¶</a>
</li>
<li id="section-3-2.4">Session key uniqueness;<a href="#section-3-2.4" class="pilcrow">¶</a>
</li>
<li id="section-3-2.5">Downgrade protection;<a href="#section-3-2.5" class="pilcrow">¶</a>
</li>
<li id="section-3-2.6">Forward secrecy with respect to long-term keys; and<a href="#section-3-2.6" class="pilcrow">¶</a>
</li>
<li id="section-3-2.7">Key Compromise Impersonation (KCI) resistance.<a href="#section-3-2.7" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-3-3">To achieve these properties, the external PSK authentication mechanism implicitly assumes one fundamental
property: each PSK is known to exactly one client and one server, and that these never switch roles.
If this assumption is violated, standard TLS 1.3 security properties are invalidated. Section <a href="#violations" class="xref">Section 3.1</a>
discusses attacks that are possible when this occurs.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="violations">
<section id="section-3.1">
        <h3 id="name-security-assumption-violati">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-security-assumption-violati" class="section-name selfRef">Security Assumption Violations</a>
        </h3>
<p id="section-3.1-1">As discussed in <a href="#use-cases" class="xref">Section 6</a>, there are use cases where multiple clients or multiple servers share a PSK. In such
cases, TLS only authenticates the entire group. Not only can a compromised group member impersonate another group
member, but a malicious non-member can reroute handshakes between honest group members to connect them in unintended
ways. A naive sharing of PSKs, even assuming only honest but curious participants know the key, can violate all these
properties, bar one.  Endpoint Identity Protection holds vacuously, because the client and server do not use
certificates in PSK mode. (This is not true with use of the "tls_cert_with_extern_psk" extension
<span>[<a href="#I-D.ietf-tls-tls13-cert-with-extern-psk" class="xref">I-D.ietf-tls-tls13-cert-with-extern-psk</a>]</span>.)<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">In the following sub-sections, we list attacks that demonstrate violations of these properties when the fundamental PSK
assumption does not hold.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<div id="redirection-selfie-style">
<section id="section-3.1.1">
          <h4 id="name-redirection-selfie-style">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-redirection-selfie-style" class="section-name selfRef">Redirection (Selfie-style)</a>
          </h4>
<p id="section-3.1.1-1">This attack simply requires the adversary to reroute messages without changing any of their contents.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">Let the group of peers who know the key be <code>A</code>, <code>B</code>, and <code>C</code>.
The attack proceeds as follows:<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal" id="section-3.1.1-3">
            <li id="section-3.1.1-3.1">
              <code>A</code> sends a <code>ClientHello</code> to <code>B</code>.<a href="#section-3.1.1-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.1.1-3.2">The attacker intercepts the message and redirects it to <code>C</code>.<a href="#section-3.1.1-3.2" class="pilcrow">¶</a>
</li>
<li id="section-3.1.1-3.3">
              <code>C</code> responds with to <code>A</code>.<a href="#section-3.1.1-3.3" class="pilcrow">¶</a>
</li>
<li id="section-3.1.1-3.4">
              <code>A</code> sends a <code>Finished</code> message to <code>B</code>.
<code>A</code> has completed the handshake, ostensibly with <code>B</code>.<a href="#section-3.1.1-3.4" class="pilcrow">¶</a>
</li>
<li id="section-3.1.1-3.5">The attacker redirects the <code>Finished</code> message to <code>C</code>.
<code>C</code> has completed the handshake, ostensibly with <code>A</code>.<a href="#section-3.1.1-3.5" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-3.1.1-4">This attack violates the peer authentication property, and if <code>C</code> supports a weaker set of cipher suites than <code>B</code>, this
attack also violates the downgrade protection property.  This rerouting is a type of identity misbinding attack
<span>[<a href="#Krawczyk" class="xref">Krawczyk</a>]</span><span>[<a href="#Sethi" class="xref">Sethi</a>]</span>.  Selfie attack <span>[<a href="#Selfie" class="xref">Selfie</a>]</span> is a special case of the rerouting attack against a group member that
can act both as TLS server and client. In the Selfie attack, a malicious non-member reroutes a connection from the
client to the server on the same endpoint.<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lack-of-dhe">
<section id="section-3.1.2">
          <h4 id="name-lack-of-dhe">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-lack-of-dhe" class="section-name selfRef">Lack of DHE</a>
          </h4>
<p id="section-3.1.2-1">If the client performs a PSK-based handshake without a DHE exchange, then another trivial attack is possible.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">Let the group of peers who know the key be <code>A</code>, <code>B</code>, and <code>C</code>.
The attack proceeds as follows:<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal" id="section-3.1.2-3">
            <li id="section-3.1.2-3.1">
              <code>A</code> sends a <code>ClientHello</code> to <code>B</code>, without including a key share.<a href="#section-3.1.2-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.1.2-3.2">The handshake completes as expected.<a href="#section-3.1.2-3.2" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-3.1.2-4">This attack violates the secrecy of session keys property, because even an honest but curious <code>C</code> can decrypt the
session between <code>A</code> and <code>B</code>.  This attack also violates forward secrecy, because a future compromise of <code>C</code> reveals the
contents of the session, however <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> notes that PSK-based handshakes without a fresh DHE do not achieve this
property.<a href="#section-3.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compromise-of-an-uninvolved-node">
<section id="section-3.1.3">
          <h4 id="name-compromise-of-an-uninvolved">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-compromise-of-an-uninvolved" class="section-name selfRef">Compromise of an uninvolved node</a>
          </h4>
<p id="section-3.1.3-1">If the attacker compromises a client or server then the session is definitionally insecure, however sharing the key with
more than one client and one server means that compromise of a different actor can lead to attacks.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.1.3-2">Let the group of peers who know the key be <code>A</code>, <code>B</code>, and <code>C</code>.
The attack proceeds as follows:<a href="#section-3.1.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal" id="section-3.1.3-3">
            <li id="section-3.1.3-3.1">Let the attacker compromise <code>C</code>.<a href="#section-3.1.3-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.1.3-3.2">
              <code>A</code> sends a <code>ClientHello</code> to <code>B</code>.<a href="#section-3.1.3-3.2" class="pilcrow">¶</a>
</li>
<li id="section-3.1.3-3.3">The attacker intercepts the message and creates a new <code>ClientHello</code>.<a href="#section-3.1.3-3.3" class="pilcrow">¶</a>
</li>
<li id="section-3.1.3-3.4">The attacker sends the new <code>ClientHello</code> to <code>B</code>.<a href="#section-3.1.3-3.4" class="pilcrow">¶</a>
</li>
<li id="section-3.1.3-3.5">
              <code>B</code> responds to <code>A</code>.<a href="#section-3.1.3-3.5" class="pilcrow">¶</a>
</li>
<li id="section-3.1.3-3.6">The attacker intercepts the message and creates a new response.<a href="#section-3.1.3-3.6" class="pilcrow">¶</a>
</li>
<li id="section-3.1.3-3.7">The attacker sends the new response to <code>A</code>.<a href="#section-3.1.3-3.7" class="pilcrow">¶</a>
</li>
<li id="section-3.1.3-3.8">
              <code>A</code> sends a <code>Finished</code> message to <code>B</code>.
<code>A</code> has completed the handshake, ostensibly with <code>B</code>.<a href="#section-3.1.3-3.8" class="pilcrow">¶</a>
</li>
<li id="section-3.1.3-3.9">The attacker intercepts the <code>Finished</code> message and creates a new <code>Finished</code> message.<a href="#section-3.1.3-3.9" class="pilcrow">¶</a>
</li>
<li id="section-3.1.3-3.10">The attacker sends the new <code>Finished</code> message to <code>B</code>.
<code>B</code> has completed the handshake, ostensibly with <code>A</code>.<a href="#section-3.1.3-3.10" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-3.1.3-4">This attack, and minor variants of it, violate the remaining properties outlined above.
The attack violates the same session keys property, as <code>A</code> and <code>B</code> have each completed a session, ostensibly with each
other, and yet do not agree on the session key.  If <code>A</code> does not send a key share, then the attacker can have a session
with <code>A</code> and a separate session with <code>B</code>, where both sessions have the same key. This violates the uniqueness of session
keys property.  In the case of KCI resistance, where we assume the attacker has compromised <code>A</code>, the attacker can
successfully impersonate <code>B</code> to <code>A</code> using this pattern.<a href="#section-3.1.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="recommendations-for-external-psk-usage">
<section id="section-4">
      <h2 id="name-recommendations-for-externa">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-recommendations-for-externa" class="section-name selfRef">Recommendations for External PSK Usage</a>
      </h2>
<p id="section-4-1">Given the desired security goals from <a href="#sec-properties" class="xref">Section 3</a>, applications which make use of
external PSKs MUST adhere to the following requirements:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-2.1">Each PSK MUST NOT be shared between with more than two logical nodes. As a result, an agent
that acts as both a client and a server MUST use distinct PSKs when acting as the client from
when it is acting as the server.<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
<li id="section-4-2.2">Nodes SHOULD use external PSK importers <span>[<a href="#I-D.ietf-tls-external-psk-importer" class="xref">I-D.ietf-tls-external-psk-importer</a>]</span>
when configuring PSKs for individual TLS connections.<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
<li id="section-4-2.3">Each PSK MUST be at least 128-bits long.<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="privacy-properties">
<section id="section-5">
      <h2 id="name-privacy-properties">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-privacy-properties" class="section-name selfRef">Privacy Properties</a>
      </h2>
<p id="section-5-1">PSK privacy properties are orthogonal to security properties described in <a href="#sec-properties" class="xref">Section 3</a>.
Traditionally, TLS does little to keep PSK identity information private. For example,
an adversary learns information about the external PSK or its identifier by virtue of it
appearing in cleartext in a ClientHello. As a result, a passive adversary can link
two or more connections together that use the same external PSK on the wire. Applications should
take precautions when using external PSKs if these risks.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">In addition to linkability in the network, external PSKs are intrinsically linkable by PSK receivers.
Specifically, servers can link successive connections that use the same external PSK together. Preventing
this type of linkability is out of scope, as PSKs are explicitly designed to support mutual authentication.<a href="#section-5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-cases">
<section id="section-6">
      <h2 id="name-external-psk-use-cases-and-">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-external-psk-use-cases-and-" class="section-name selfRef">External PSK Use Cases and Provisioning Processes</a>
      </h2>
<p id="section-6-1">Pre-shared Key (PSK) ciphersuites were first specified for TLS in 2005. Now, PSK is an integral
part of the TLS version 1.3 specification <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>. TLS 1.3 also uses PSKs for session resumption.
It distinguishes these resumption PSKs from external PSKs which have been provisioned out-of-band (OOB).
Below, we list some example use-cases where pair-wise external PSKs with TLS have been used for
authentication.<a href="#section-6-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6-2.1">Device-to-device communication with out-of-band synchronized keys. PSKs provisioned out-of-band
for communicating with known identities, wherein the identity to use is discovered via a different
online protocol.<a href="#section-6-2.1" class="pilcrow">¶</a>
</li>
<li id="section-6-2.2">Intra-data-center communication. Machine-to-machine communication within a single data center
or PoP may use externally provisioned PSKs, primarily for the purposes of supporting TLS
connections with fast open (0-RTT data).<a href="#section-6-2.2" class="pilcrow">¶</a>
</li>
<li id="section-6-2.3">Internet of Things (IoT) and devices with limited computational capabilities. <span>[<a href="#RFC7925" class="xref">RFC7925</a>]</span>
defines TLS and DTLS profiles for resource-constrained devices and suggests the use of PSK
ciphersuites for compliant devices.<a href="#section-6-2.3" class="pilcrow">¶</a>
</li>
<li id="section-6-2.4">Use of PSK ciphersuites are optional when securing RADIUS <span>[<a href="#RFC2865" class="xref">RFC2865</a>]</span> with TLS as specified
in <span>[<a href="#RFC6614" class="xref">RFC6614</a>]</span>.<a href="#section-6-2.4" class="pilcrow">¶</a>
</li>
<li id="section-6-2.5">The Generic Authentication Architecture (GAA) defined by 3GGP mentions that TLS-PSK can be used
between a server and user equipment for authentication <span>[<a href="#GAA" class="xref">GAA</a>]</span>.<a href="#section-6-2.5" class="pilcrow">¶</a>
</li>
<li id="section-6-2.6">Smart Cards. The electronic German ID (eID) card supports authentication of a card holder to
online services with TLS-PSK <span>[<a href="#SmartCard" class="xref">SmartCard</a>]</span>.<a href="#section-6-2.6" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-6-3">There are also use cases where PSKs are shared between more than two entities. Some examples below
(as noted by Akhmetzyanova et al.<span>[<a href="#Akhmetzyanova" class="xref">Akhmetzyanova</a>]</span>):<a href="#section-6-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-6-4.1">Group chats. In this use-case, the membership of a group is confirmed by the possession of a PSK
distributed out-of-band to the group participants. Members can then establish peer-to-peer connections
with each other using the external PSK. It is important to note that any node of the group can behave
as a TLS client or server.<a href="#section-6-4.1" class="pilcrow">¶</a>
</li>
<li id="section-6-4.2">Internet of Things (IoT). In this use-case, resource-constrained IoT devices act as TLS clients and share the
same PSK. The devices use this PSK for quickly establishing connections with a central server. Such a scheme
ensures that the client IoT devices are legitimate members of the system. To perform rare system specific
operations that require a higher security level, the central server can request resource-intensive client
authentication with the usage of a certificate after successfully establishing the connection with a PSK.<a href="#section-6-4.2" class="pilcrow">¶</a>
</li>
</ul>
<div id="provisioning-examples">
<section id="section-6.1">
        <h3 id="name-provisioning-examples">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-provisioning-examples" class="section-name selfRef">Provisioning Examples</a>
        </h3>
<ul>
<li id="section-6.1-1.1">Many industrial protocols assume that PSKs are distributed and assigned manually via one of the following
approaches: typing the PSK into the devices, or via web server masks (using a Trust On First Use (TOFU)
approach with a device completely unprotected before the first login did take place). Many devices have very
limited UI. For example, they may only have a numeric keypad or even less number of buttons. When the TOFU
approach is not suitable, entering the key would require typing it on a constrained UI. Moreover, PSK production
lacks guidance unlike user passwords.<a href="#section-6.1-1.1" class="pilcrow">¶</a>
</li>
<li id="section-6.1-1.2">Some devices are provisioned PSKs via an out-of-band, cloud-based syncing protocol.<a href="#section-6.1-1.2" class="pilcrow">¶</a>
</li>
<li id="section-6.1-1.3">Secrets may be baked into or hardware or software device components, such as secure enclaves.<a href="#section-6.1-1.3" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="provisioning-constraints">
<section id="section-6.2">
        <h3 id="name-provisioning-constraints">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-provisioning-constraints" class="section-name selfRef">Provisioning Constraints</a>
        </h3>
<p id="section-6.2-1">PSK provisioning systems are often constrained in application-specific ways. For example, although one goal of
provisioning is to ensure that each pair of nodes has a unique key pair, some systems do not want to distribute
pair-wise shared keys to achieve this. As another example, some systems require the provisioning process to embed
application-specific information in either PSKs or their identities. Identities may sometimes need to be routable,
as is currently under discussion for EAP-TLS-PSK.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="stack-interfaces">
<section id="section-6.3">
        <h3 id="name-stack-interfaces">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-stack-interfaces" class="section-name selfRef">Stack Interfaces</a>
        </h3>
<p id="section-6.3-1">Most major TLS implementations support external PSKs. And all have a common interface that
applications may use when supplying them for individual connections. Details about existing
stacks at the time of writing are below.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.3-2.1">OpenSSL and BoringSSL: Applications specify support for external PSKs via distinct ciphersuites.
They also then configure callbacks that are invoked for PSK selection during the handshake.
These callbacks must provide a PSK identity (as a character string) and key (as a byte string).
(If no identity is provided, a default one is assumed.)
They are typically invoked with a PSK hint, i.e., the hint provided by the server as per <span>[<a href="#RFC4279" class="xref">RFC4279</a>]</span>.
The PSK length is validated to be between [1, 256] bytes upon selection.<a href="#section-6.3-2.1" class="pilcrow">¶</a>
</li>
<li id="section-6.3-2.2">mbedTLS: Client applications configure PSKs before creating a connection by providing the PSK
identity and value inline. Servers must implement callbacks similar to that of OpenSSL. PSK lengths
are validate to be between [1, 16] bytes.<a href="#section-6.3-2.2" class="pilcrow">¶</a>
</li>
<li id="section-6.3-2.3">gnuTLS: Applications configure PSK values, either as raw byte strings or hexadecimal strings. The PSK size is not validated.<a href="#section-6.3-2.3" class="pilcrow">¶</a>
</li>
<li id="section-6.3-2.4">wolfSSL: Applications configure PSKs with callbacks similar to OpenSSL.<a href="#section-6.3-2.4" class="pilcrow">¶</a>
</li>
</ul>
<div id="psk-identity-encoding-and-comparison">
<section id="section-6.3.1">
          <h4 id="name-psk-identity-encoding-and-c">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-psk-identity-encoding-and-c" class="section-name selfRef">PSK Identity encoding and comparison</a>
          </h4>
<p id="section-6.3.1-1">Section 5.1 of <span>[<a href="#RFC4279" class="xref">RFC4279</a>]</span> mandates that the PSK identity should be first converted to a character string
and then encoded to octets using UTF-8. This was done to avoid interoperability problems (especially when
the identity is configured by human users). On the other hand, <span>[<a href="#RFC7925" class="xref">RFC7925</a>]</span> advises implementations against
assuming any structured format for PSK identities and recommends byte-by-byte comparison for any operations.
TLS version 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> follows the same practice of specifying the psk identity as a sequence of opaque
bytes (shown as opaque identity&lt;1..2^16-1&gt;).<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.3.1-2">Other assumptions unique to different stacks are listed below.<a href="#section-6.3.1-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.3.1-3.1">Implementations such as OpenSSL and mbedTLS nonetheless treat psk_identities as character strings and use
string operators such as <code>strcmp</code> on the psk identity.<a href="#section-6.3.1-3.1" class="pilcrow">¶</a>
</li>
<li id="section-6.3.1-3.2">Implementations also assign default identities to PSKs (for example, the string 'Client_identity') if none are configured.<a href="#section-6.3.1-3.2" class="pilcrow">¶</a>
</li>
<li id="section-6.3.1-3.3">gnuTLS treats psk identities as usernames.<a href="#section-6.3.1-3.3" class="pilcrow">¶</a>
</li>
<li id="section-6.3.1-3.4">OpenSSL servers accept connections from clients that have a valid PSK even if the identity provided by
the client is incorrect.<a href="#section-6.3.1-3.4" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document makes no IANA requests.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-tls-external-psk-importer">[I-D.ietf-tls-external-psk-importer]</dt>
<dd>
<span class="refAuthor">Benjamin, D.</span><span class="refAuthor"> and C. Wood</span>, <span class="refTitle">"Importing External PSKs for TLS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-external-psk-importer-03</span>, <time datetime="2020-02-15">15 February 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-external-psk-importer-03.txt">http://www.ietf.org/internet-drafts/draft-ietf-tls-external-psk-importer-03.txt</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="RFC8446">[RFC8446]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Akhmetzyanova">[Akhmetzyanova]</dt>
<dd>
<span class="refAuthor">Akhmetzyanova, L.</span><span class="refAuthor">, Alekseev, E.</span><span class="refAuthor">, Smyshlyaeva, E.</span><span class="refAuthor">, and A. Sokolov</span>, <span class="refTitle">"Continuing to reflect on TLS 1.3 with external PSK"</span>, <time datetime="2019">2019</time>, <span>&lt;<a href="https://eprint.iacr.org/2019/421.pdf">https://eprint.iacr.org/2019/421.pdf</a>&gt;</span>. </dd>
<dt id="GAA">[GAA]</dt>
<dd>
<span class="refTitle">"TR33.919 version 12.0.0 Release 12"</span>, <time datetime="n.d.">n.d.</time>, <span>&lt;<a href="https://www.etsi.org/deliver/etsi_tr/133900_133999/133919/12.00.00_60/tr_133919v120000p.pdf">https://www.etsi.org/deliver/etsi_tr/133900_133999/133919/12.00.00_60/tr_133919v120000p.pdf</a>&gt;</span>. </dd>
<dt id="I-D.ietf-tls-tls13-cert-with-extern-psk">[I-D.ietf-tls-tls13-cert-with-extern-psk]</dt>
<dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"TLS 1.3 Extension for Certificate-based Authentication with an External Pre-Shared Key"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-tls13-cert-with-extern-psk-07</span>, <time datetime="2019-12-23">23 December 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-tls13-cert-with-extern-psk-07.txt">http://www.ietf.org/internet-drafts/draft-ietf-tls-tls13-cert-with-extern-psk-07.txt</a>&gt;</span>. </dd>
<dt id="Krawczyk">[Krawczyk]</dt>
<dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refTitle">"SIGMA: The 'SIGn-and-MAc' Approach to Authenticated Diffie-Hellman and Its Use in the IKE Protocols"</span>, <span class="seriesInfo">Annual International Cryptology Conference. Springer, Berlin, Heidelberg </span>, <time datetime="2003">2003</time>, <span>&lt;<a href="https://link.springer.com/content/pdf/10.1007/978-3-540-45146-4_24.pdf">https://link.springer.com/content/pdf/10.1007/978-3-540-45146-4_24.pdf</a>&gt;</span>. </dd>
<dt id="RFC2865">[RFC2865]</dt>
<dd>
<span class="refAuthor">Rigney, C.</span><span class="refAuthor">, Willens, S.</span><span class="refAuthor">, Rubens, A.</span><span class="refAuthor">, and W. Simpson</span>, <span class="refTitle">"Remote Authentication Dial In User Service (RADIUS)"</span>, <span class="seriesInfo">RFC 2865</span>, <span class="seriesInfo">DOI 10.17487/RFC2865</span>, <time datetime="2000-06">June 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2865">https://www.rfc-editor.org/info/rfc2865</a>&gt;</span>. </dd>
<dt id="RFC4279">[RFC4279]</dt>
<dd>
<span class="refAuthor">Eronen, P., Ed.</span><span class="refAuthor"> and H. Tschofenig, Ed.</span>, <span class="refTitle">"Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 4279</span>, <span class="seriesInfo">DOI 10.17487/RFC4279</span>, <time datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4279">https://www.rfc-editor.org/info/rfc4279</a>&gt;</span>. </dd>
<dt id="RFC6614">[RFC6614]</dt>
<dd>
<span class="refAuthor">Winter, S.</span><span class="refAuthor">, McCauley, M.</span><span class="refAuthor">, Venaas, S.</span><span class="refAuthor">, and K. Wierenga</span>, <span class="refTitle">"Transport Layer Security (TLS) Encryption for RADIUS"</span>, <span class="seriesInfo">RFC 6614</span>, <span class="seriesInfo">DOI 10.17487/RFC6614</span>, <time datetime="2012-05">May 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6614">https://www.rfc-editor.org/info/rfc6614</a>&gt;</span>. </dd>
<dt id="RFC7925">[RFC7925]</dt>
<dd>
<span class="refAuthor">Tschofenig, H., Ed.</span><span class="refAuthor"> and T. Fossati</span>, <span class="refTitle">"Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things"</span>, <span class="seriesInfo">RFC 7925</span>, <span class="seriesInfo">DOI 10.17487/RFC7925</span>, <time datetime="2016-07">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7925">https://www.rfc-editor.org/info/rfc7925</a>&gt;</span>. </dd>
<dt id="Selfie">[Selfie]</dt>
<dd>
<span class="refAuthor">Drucker, N.</span><span class="refAuthor"> and S. Gueron</span>, <span class="refTitle">"Selfie: reflections on TLS 1.3 with PSK"</span>, <time datetime="2019">2019</time>, <span>&lt;<a href="https://eprint.iacr.org/2019/347.pdf">https://eprint.iacr.org/2019/347.pdf</a>&gt;</span>. </dd>
<dt id="Sethi">[Sethi]</dt>
<dd>
<span class="refAuthor">Sethi, M.</span><span class="refAuthor">, Peltonen, A.</span><span class="refAuthor">, and T. Aura</span>, <span class="refTitle">"Misbinding Attacks on Secure Device Pairing and Bootstrapping"</span>, <span class="seriesInfo">Proceedings of the 2019 ACM Asia Conference on Computer and Communications Security </span>, <time datetime="2019">2019</time>, <span>&lt;<a href="https://arxiv.org/pdf/1902.07550">https://arxiv.org/pdf/1902.07550</a>&gt;</span>. </dd>
<dt id="SmartCard">[SmartCard]</dt>
<dd>
<span class="refTitle">"Technical Guideline TR-03112-7 eCard-API-Framework - Protocols"</span>, <time datetime="2015">2015</time>, <span>&lt;<a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR03112/TR-03112-api_teil7.pdf?__blob=publicationFile&amp;v=1">https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR03112/TR-03112-api_teil7.pdf?__blob=publicationFile&amp;v=1</a>&gt;</span>. </dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="section-appendix.a">
      <h2 id="name-acknowledgements">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.a-1">This document is the output of the TLS External PSK Design Team, comprised of the following members:
Benjamin Beurdouche,
Bjoern Haase,
Chris Wood,
Colm MacCarthaigh,
Eric Rescorla,
Jonathan Hoyland,
Martin Thomson,
Mohamad Badra,
Mohit Sethi,
Oleg Pekar,
Owen Friel, and
Russ Housley.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Foo Bar</span></div>
<div dir="auto" class="left"><span class="org">Baz, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:foobar@baz.com" class="email">foobar@baz.com</a>
</div>
</address>
</section>
</div>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>
</body>
</html>
